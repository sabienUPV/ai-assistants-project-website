---
import { supportedLangs } from "@languages";
import { baseUrl as base } from "@utils/url"

const defaultLang = "en";
---

<!DOCTYPE html>
<html lang={defaultLang}>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Redirecting...</title>

    <meta http-equiv="refresh" content={`0;url=${base}/${defaultLang}/`} />

    <script is:inline define:vars={{ supportedLangs, base, defaultLang }}>
      const userLang = navigator.language || "";
      const matchedLang = supportedLangs.find(lang => userLang.startsWith(lang));
      window.location.replace(`${base}/${matchedLang || defaultLang}/`);
    </script>

    <style>
      /* The Logic:
         1. Start completely hidden (opacity: 0).
         2. Wait 0.1 seconds.
         3. Snap to visible (opacity: 1).
      */
      .fallback-message {
        opacity: 0;
        animation: reveal 0s 0.1s forwards; /* Duration: 0s, Delay: 0.1s */
        
        /* Make it look decent if it does appear */
        font-family: system-ui, sans-serif;
        text-align: center;
        margin-top: 2rem;
        color: #333;
      }

      @keyframes reveal {
        to { opacity: 1; }
      }
    </style>
  </head>
  <body>
    
    <div class="fallback-message">
      <p>Redirecting you to the English version...</p>
      <p>
        <a href={`${base}/${defaultLang}/`}>Click here manually if nothing happens.</a>
      </p>
    </div>

  </body>
</html>